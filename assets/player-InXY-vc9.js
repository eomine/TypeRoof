var g=Object.defineProperty;var s=(n,e)=>g(n,"name",{value:e,configurable:!0});import{F as f,G as v,V as b,w as T,T as P,x as L,b as A,P as S,y as V,n as E,z as C,B as F,D as O,_ as d,H as w}from"./type-tools-grid-GNboIlnR.js";const a=Symbol("LAYOUT_GROUP_DEFAULT"),l=Object.fromEntries([[a,{label:"TypeRoof Original"}]].map(([n,e],t)=>[n,Object.freeze(Object.assign({},e,{index:t}))]));Object.defineProperty(l,"default",{value:a,enumerable:!1});Object.freeze(l);const p=Object.freeze([["StageAndActors","Stage and Actors",v,a],["VideoproofArrayDev","Videoproof Array (Interim)",b,a],["VideoproofArray","Array",T,a],["TypeToolsGrid","Grid",P,a],["TypeSpecRamp","TypeSpec - Ramp",L,a]]);function u(n,e,t,...i){n.addEventListener(e,t,...i)}s(u,"_addListener");function h(n,e,t,...i){n.removeEventListener(e,t,...i)}s(h,"_removeListener");class z extends d{static{s(this,"UIVisibilityManager")}visibleClass="visible";constructor(e,t){super(e),this._isPlayingPath=t,this.node=e.wrapper.host,this._timeout=null,this._listenerPointermove=null,this._listenerPointerleave=null,this._mode=null;for(const i of["screengrab","no-chrome"])if(e.uiFlags.has(i)){this.setMode(i);break}this._mode===null&&this.setMode("default")}setMode(e){this._mode=e;const t=this.getEntry("/"),i=w(t,this._isPlayingPath,{value:!0}).value;this.setPlayingState(i)}_startListening(){this._listenerPointermove===null&&(this._listenerPointermove=[this.node,"pointermove",()=>this._addVisibilityAndTimeout()],u(...this._listenerPointermove),this._listenerPointerleave=[this.node,"pointerleave",()=>this._removeVisibilty()],u(...this._listenerPointerleave))}_stopListening(){this._listenerPointermove!==null&&(h(...this._listenerPointermove),this._listenerPointermove=null,h(...this._listenerPointerleave),this._listenerPointerleave=null)}_addVisibilityAndTimeout(e=1500){this._addVisibility(),this._cancelTimeout(),this._timeout=this._domTool.window.setTimeout(this._removeVisibilty.bind(this),e)}_cancelTimeout(){this._timeout!==null&&this._domTool.window.clearTimeout(this._timeout),this._timeout=null}_addVisibility(){this.node.classList.add(this.visibleClass)}_removeVisibilty(){this.node.classList.remove(this.visibleClass)}destroy(){this._cancelTimeout(),this._stopListening(),this._removeVisibilty(),super.destroy()}_toggleVisibilityAutomatic(e,t=!0){e?(this._startListening(),t?this._addVisibilityAndTimeout(0):this._removeVisibilty()):(this._cancelTimeout(),this._stopListening(),t?this._addVisibility():this._removeVisibilty())}setPlayingState(e){let t,i=!0;this._mode==="no-chrome"?(t=!1,i=!1):this._mode==="screengrab"?t=!0:t=e,this._toggleVisibilityAutomatic(t,i)}}class M extends d{static{s(this,"MonitorPlayingState")}constructor(e,t){super(e),this._onChange=t}update(e){if(e.has("playing")){const t=e.get("playing").value;this._onChange(t)}}}class U extends d{static{s(this,"ToggleFullscreen")}static TEMPLATE=`
        <button class="ui_toggle_fullscreen">
            Toggle Fullscreen
            <span class="material-symbols-outlined">open_in_full</span>
        </button>
    `;constructor(e,t){super(e),this._element=this._initTemplate(t)}_initTemplate(e){const t=this._domTool.createFragmentFromHTML(this.constructor.TEMPLATE).firstElementChild;return this._insertElement(t),t.addEventListener("click",()=>{if(document.fullscreenElement){document.exitFullscreen();return}e.requestFullscreen().catch(i=>{console.error(`${this} Error enabling fullscreen: ${i.message}`)})}),[t]}}class D extends A{static{s(this,"MainUIController")}constructor(e){const t=new Map([["main",".typeroof-ui_main"],["after-main",".typeroof-ui_main-after"],["before-layout",".typeroof-layout-before"],["layout",".typeroof-layout"],["after-layout",".typeroof-layout-after"],["wrapper","body .wrapper"]].map(([o,m])=>[o,e.domTool.document.querySelector(m)])),i=e.domTool.createElement("div",{class:"general-settings"}),c=e.domTool.createElement("div",{class:"fonts-manager"});t.set("general-settings",i),t.set("fonts-manager",c);const r=S.fromParts(".","activeState"),_=[[{zone:"wrapper",id:"visibility-manager"},[],z,r.append("playing")],[{rootPath:r,zone:"main",activationTest:s(()=>this.widgetBus.getEntry(r).has("playing"),"activationTest")},["playing"],M,function(o){this.widgetBus.getWidgetById("visibility-manager").setPlayingState(o)}],...p.map(([,,o])=>[{rootPath:r,zone:"main",activationTest:s(()=>this.widgetBus.getEntry(r).WrappedType===o.Model,"activationTest")},[],o.Controller,t]),[{zone:"main"},[],V,l],[{zone:"main"},[],E,i],[{zone:"main"},[],C,"Font",c],[{zone:"fonts-manager"},["activeFontKey","availableFonts","installedFonts"],F],[{zone:"fonts-manager"},["activeFontKey"],O,e.domTool.document.body,"â€¦ or drag a font file onto the window"],[{zone:"general-settings"},[],U,e.domTool.document.body]];super(e,t,_)}get dependencies(){const e=super.dependencies;return e.add("/activeState"),e}get modelDependencies(){const e=super.modelDependencies;return e.add("/activeState"),e}}function y(){G.setInitialDependency("ready",!0)}s(y,"main");const G=new f(window,{MainUIController:D,Layouts:p,LAYOUT_GROUPS:l});document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y();
